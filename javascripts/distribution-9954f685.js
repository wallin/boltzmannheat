(function(){angular.module("bm.distribution",[]).service("Distribution",[function(){var e;return e={},e.energyLevels=function(e){var r,n,t,l,a,i,u,o,s,y,g,v,f,c,b;switch(y=1e4,i=new Array(y),l=new Array(y),a=new Array(y),n=e.eDist,t=e.subEDist,e.eLevelType.value){case"equidistant":for(t=0,o=g=0;y>=0?y>=g:g>=y;o=y>=0?++g:--g)i[o]=o*n,l[o]=1;break;case"sublevels":for(r=0,u=v=0,c=e.numSubLevels;c>0?y>=v:v>=y;u=v+=c){for(s=f=0,b=e.numSubLevels;b>=0?b>=f:f>=b;s=b>=0?++f:--f)i[u+s]=r*n+s*t,l[u+s]=1,a[u+s]=u*n;r++}break;case"rotational":throw"TODO!"}return{energyLevels:i,degeneracy:l,energyLevelMainDiff:n,energyLevelSubDiff:t}},e.boltzmann=function(r,n){var t,l,a,i,u,o,s,y,g,v,f,c,b,p,h,L,m,d,D,w,M,P;if(null==n&&(n={}),l=e.energyLevels(r),f=[],c=0,a=r.temperature,i=0,u=0,v=r.numParticles,0===a)for(f.push([1,0]),c=1,M=l.energyLevels,b=0,m=M.length;m>b;b++)y=M[b],f.push([0,y]);else for(P=l.energyLevels,o=p=0,d=P.length;d>p;o=++p)y=P[o],f.push([l.degeneracy[o]*Math.exp(-l.energyLevels[o]/a),y]),c+=f[o][0];for(o=h=0,D=f.length;D>h;o=++h)s=f[o],s[0]/=c,s[0]>0&&(u+=-s[0]*Math.log(s[0]),i+=s[0]*l.energyLevels[o]);if(n.plotRel)for(g=f[0][0],L=0,w=f.length;w>L;L++)s=f[L],s[0]>0&&(s[0]/=g);return t=8.3145,angular.extend({},l,{probability:f,partitionFun:c,numParticles:v,energyParticle:i,energyTotal:i*t*v/1e3,energyMolar:i*t/1e3,entropyParticle:u,entropyTotal:u*t*v,entropyMolar:u*t,temperature:a})},e}])}).call(this);